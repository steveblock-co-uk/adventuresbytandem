This is copied from shared Scripts - should pull out bits we need!
